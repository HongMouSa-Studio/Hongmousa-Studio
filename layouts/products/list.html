{{ define "main" }}
<section class="product-page-list">
  <header class="section-header">
    <h1 class="section-title">{{ .Title }}</h1>
    <span class="section-sub">{{ i18n "product_section_sub" }}</span>
  </header>

  <div class="product-grid">
    {{ range .Pages.ByWeight }}
    <div class="product-card">
      <div class="product-image-wrapper">
        <img
          src="{{ .Params.image }}"
          alt="{{ .Title }}"
          class="product-img"
        />

        <!-- Snipcart Button -->
        <button
          class="snipcart-add-item add-to-cart-btn"
          data-item-id="{{ .Params.id }}"
          data-item-price="{{ .Params.price }}"
          data-item-url="{{ .RelPermalink }}"
          data-item-image="{{ .Params.image }}"
          data-item-name="{{ .Title }}"
          data-item-description="{{ .Params.description }}"
          
          {{ range $index, $opt := .Params.options }}
            {{ $snipIndex := add $index 1 }}
            {{ $slug := index (slice "font" "conversion" "material" "engraving") $index }}
            data-item-custom{{ $snipIndex }}-name="{{ $slug }}"
            data-item-custom{{ $snipIndex }}-options="{{ range $vIndex, $val := $opt.values }}{{ if $vIndex }}|{{ end }}{{ if reflect.IsMap $val }}{{ $val.name }} {{ if $val.price }}[+{{ printf "%.2f" $val.price }}]{{ end }}{{ else }}{{ $val }}{{ end }}{{ end }}"
          {{ end }}
        >
          {{ i18n "product_btn_add" }}
        </button>
      </div>
      <div class="product-info">
        <h3 class="font-serif">{{ .Title }}</h3>
        {{ if .Params.category }}
        <p>{{ .Params.category }}{{ if .Params.tags }} / {{ index .Params.tags 0 }}{{ end }}</p>
        {{ end }}
        <div class="product-price">
          {{ printf (i18n "product_price_format") .Params.price }}
        </div>
        <!-- Learn More Link -->
        <a href="{{ .RelPermalink }}" class="learn-more-link">
          {{ i18n "product_learn_more" }}
        </a>
      </div>
    </div>
    {{ end }}
  </div>
</section>
{{ end }}
