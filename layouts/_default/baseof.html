<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">
<head>
  <meta charset="utf-8">
  <title>{{ .Title }}</title>

  {{ partial "head.html" . }}

  {{ $styles := resources.Get "css/tailwind.css" | postCSS }}
  <link rel="stylesheet" href="{{ $styles.Permalink }}">
</head>

<body>
  {{ partial "header.html" . }}
  {{ partial "hero.html" . }}
  {{ partial "nav.html" . }}

  <main>
    {{ block "main" . }}{{ end }}
  </main>

  {{ partial "footer.html" . }}

  {{ partial "lang-redirect.html" . }}

  <script>
    (function() {
      // Nā sī localhost：1313, to̍h mài chò redirect (Pī-bián loop)
      if (location.host.includes("localhost")) return;
      
      const cookie = document.cookie
        .split("; ")
        .find(row => row.startsWith("preferred_lang="));

      if (!cookie) return;

      const lang = cookie.split("=")[1];

      // Cloudflare Pages su-iàu iōng siong-tùi lō͘-kèng chhú-lí
      const desiredPath = "/" + lang + "/";

      if (!location.pathname.startsWith(desiredPath)) {
        location.href = desiredPath;
      }
})();
</script>
      
</body>
</html>
